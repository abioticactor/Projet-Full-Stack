@inherits LayoutComponentBase

<div class="home-layout">
    <header class="home-header">
        <div class="actions">
            <button class="btn-outline-primary" @onclick="ShowRegisterModalFunc">S'inscrire</button>
            <button class="btn-primary" @onclick="ShowLoginModalFunc">Se connecter</button>
        </div>
    </header>

    <main class="home-main">
        @Body
    </main>
</div>

<!-- Modal Backdrop -->
@if (IsLoginModalOpen || IsRegisterModalOpen)
{
    <div class="modal-backdrop" @onclick="CloseModals"></div>
}

<!-- Login Modal -->
@if (IsLoginModalOpen)
{
    <div class="modal-container">
        <div class="modal-content">
            <button class="modal-close" @onclick="CloseModals">✕</button>
            <h2>Se connecter</h2>
            <form @onsubmit="HandleLogin">
                <div class="form-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" @bind="LoginEmail" required />
                </div>
                <div class="form-group">
                    <label for="login-password">Mot de passe</label>
                    <input type="password" id="login-password" @bind="LoginPassword" required />
                </div>
                <button type="submit" class="btn-primary">Se connecter</button>
            </form>
        </div>
    </div>
}

<!-- Register Modal -->
@if (IsRegisterModalOpen)
{
    <div class="modal-container">
        <div class="modal-content">
            <button class="modal-close" @onclick="CloseModals">✕</button>
            <h2>S'inscrire</h2>
            <form @onsubmit="HandleRegister">
                <div class="form-group">
                    <label for="register-username">Nom d'utilisateur</label>
                    <input type="text" id="register-username" @bind="RegisterUsername" required />
                </div>
                <div class="form-group">
                    <label for="register-email">Email</label>
                    <input type="email" id="register-email" @bind="RegisterEmail" required />
                </div>
                <div class="form-group">
                    <label for="register-password">Mot de passe</label>
                    <input type="password" id="register-password" @bind="RegisterPassword" required />
                </div>
                <div class="form-group">
                    <label for="register-confirm-password">Confirmer le mot de passe</label>
                    <input type="password" id="register-confirm-password" @bind="RegisterConfirmPassword" required />
                </div>
                <button type="submit" class="btn-primary">S'inscrire</button>
            </form>
        </div>
    </div>
}

@code {
    private bool IsLoginModalOpen = false;
    private bool IsRegisterModalOpen = false;

    private string LoginEmail = "";
    private string LoginPassword = "";

    private string RegisterUsername = "";
    private string RegisterEmail = "";
    private string RegisterPassword = "";
    private string RegisterConfirmPassword = "";

    private void ShowLoginModalFunc()
    {
        IsLoginModalOpen = true;
        IsRegisterModalOpen = false;
    }

    private void ShowRegisterModalFunc()
    {
        IsRegisterModalOpen = true;
        IsLoginModalOpen = false;
    }

    private void CloseModals()
    {
        IsLoginModalOpen = false;
        IsRegisterModalOpen = false;
    }

    private void HandleLogin()
    {
        // TODO: Implement login logic with backend
        Console.WriteLine($"Login: {LoginEmail}");
        CloseModals();
    }

    private void HandleRegister()
    {
        // TODO: Implement register logic with backend
        if (RegisterPassword != RegisterConfirmPassword)
        {
            Console.WriteLine("Passwords do not match");
            return;
        }
        Console.WriteLine($"Register: {RegisterUsername}, {RegisterEmail}");
        CloseModals();
    }

    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;
}